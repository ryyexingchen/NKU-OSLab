# 最小可执行程序与中断处理
## lab0.5
### 练习1: 使用GDB验证启动流程
#### 练习过程
- 启动 QEMU 和 GDB
在实验中，我们首先需要通过 make debug 启动 QEMU 并进入调试模式，然后使用 GDB 附加到 QEMU 进程中。

![image-lab0.5-1.png](image/image-lab0.5-1.png)

- RISC-V硬件加电后的几条指令

![image-lab0.5-2.png](image/image-lab0.5-2.png)

- 设置断点，模拟执行

![image-lab0.5-3.png](image/image-lab0.5-3.png)

#### 加电后的几条指令地址及其功能

##### 初始指令地址

在 RISC-V 系统的 QEMU 模拟环境下，加电后的指令从地址 0x1000 开始执行。该地址处的指令主要用于硬件的初始化操作，例如设置寄存器、加载线程 ID，并准备跳转到操作系统内核或固件入口地址。

##### 功能

- __CPU 初始化__：通过初始的几条指令，RISC-V CPU 完成了硬件的基础初始化，包括设置寄存器和加载一些基本的系统状态。指令如 `auipc t0, 0x0` 和 `addi a1, t0, 32` 用来计算内存地址，而指令 `csrr a0, mhartid` 则读取硬件线程 ID，用于多核处理器识别当前核。

- __跳转到内核入口或固件__：通过运行指令 `jr t0`，系统将跳转到寄存器 t0 中存储的地址。在大多数情况下，这个地址指向固件或操作系统内核的入口。例如，从地址 0x1000 开始的初始化流程最终会跳转到 0x80000000，这是固件的入口地址。固件初始化完成后会将控制权交给操作系统的内核入口地址 0x80200000，然后开始执行内核代码。

##### 总结
RISC-V硬件加电后的几条指令完成的内容和操作主要分为三点：
- Qemu载入相关文件，实现地址跳转
- Bootloader的加载：即作为 bootloader 的 OpenSBI.bin 被加载到物理内存以物理地址 0x80000000 开头的区域上，同时内核镜像 os.bin 被加载到以物理地址 0x80200000 开头的区域上
- 内核的执行
